<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Promises in JS</title>
        <!-- from N.J-->
    </head>
    <!-- Promises are used to handle Async operations in JS
    {}
    ->Asynchronous programming is a technique that enables your program to start a potentially long-running task and still be able to be responsive to other events while that task runs, rather than having to wait until that task has finished. Once that task has finished, your program is presented with the result.
    -> asynchronous operation means that a process operates independently of other processes, whereas synchronous operation means that the process runs only as a result of some other process being completed or handed off.
    }
    
    -->

    <body>
        <script>
        //See example in Code how things work before and after promises
        //suppose we are creating an ecommerce website and we have cart array in it
            const cart=["shoes","watch","phone","t-shirt"]; // array of strings
            //suppose we have two API's one returns orderId and another we take order and will take you to payment page
            //createOder and proceedToPayment are two APIs

            //createOrder(cart); // returns orderId
            //proceedToPayment(orderId); // takes you to payment page after receiving orderID
            
            //so these two APIs are Asynchronous and we don't know how much time they will take and they are dependent on each other(Means we can only do proceedToPayment once you have created the order)

            //handling this using call backs
            createOrder(cart,function(orderID){
                proceedToPayment(orderId);
            });
            //now its the responsibility of the createOrder API to create an order and to call the callback function once the order is created
            // with the orderId , but there is issue-> The issue is inversion of control i.e we have given the control of our code proceedToPayment to some other API and its not in our control anymore , We have just passed it and we are expecting it to randomly called isn't it risky (watch at:5:00)

            //Handling this using promises
            // here we deisgn the createOrder in such a way that it return us a orderdetails in varibale promise
            const prmoise = createOrder(cart);
            // we can assume a promise to be an empty object with some data value in it and this data value will hold what every this createOrder Api will return to it
            
            //Note: This createOrder API is an asnyc operation it will take some time to execute(we don't known how much time), but as soon asb this line "const prmoise = createOrder(cart);" is
            //executed it will return as an empty object:"undefined" -> {data:undefined}(undefined means empty value) and after some time when the createOrder executes it will create and order and it will give us order
            //details and those details will now replace undefined -> {data:orderDetails} (watch at 7:30)

            //Initially when this  "const prmoise = createOrder(cart);" is executed it will return a promise and promise is nothing but an empty object i.e undefined, and then program will continue executing the other code and then this "const prmoise = createOrder(cart);" code executes/return the orderDetails
            // The promise object will be filled with data automatically after what every async time it takes

            // after that we will attach the callback function to the promise object
            promise.then(function(orderID){
                proceedToPayment(orderId);}
            ); //(Watch at 9:00)
            // once we have data inside this promise object{data:data} this call back function that we attach to this promise object will be automatically called
            // see next code 37 promises vs callbacks
        </script>
    </body>
</html>